const host="https://u11.town",dom={btn:document.querySelector(".btn-go"),overlay:document.getElementById("overlay"),popup01:document.getElementById("popup01"),popupCenter:document.getElementById("popup_center"),btnDl:document.getElementById("popupButton")};function hideAllPopups(){[dom.popup01,dom.popupCenter].forEach(p=>{p&&p.classList.contains("show")&&(p.classList.remove("show"),setTimeout(()=>p.style.display="none",300))}),dom.overlay.style.display="none"}function deferredPromptAccept(){deferredPrompt&&(deferredPrompt.prompt(),deferredPrompt.userChoice.then((function(result){"accepted"===result.outcome&&(deferredPrompt=null)})))}function getSearchParams(){const params=new URLSearchParams(window.location.search);return params.toString()?"?"+params.toString():""}function iOS(){const userAgent=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod|mac.*touch/.test(userAgent)&&/safari/.test(navigator.vendor.toLowerCase())}dom.btn.addEventListener("click",()=>{window.location.href=host+getSearchParams()}),dom.btnDl.addEventListener("click",(function(e){e.stopPropagation(),iOS()?(dom.overlay.style.display="block",dom.popup01.style.display="block",setTimeout(()=>dom.popup01.classList.add("show"),10)):deferredPromptAccept()})),dom.popup01.addEventListener("click",(function(e){e.stopPropagation(),dom.popup01.classList.remove("show"),setTimeout(()=>{dom.popup01.style.display="none",dom.popupCenter.style.display="block",setTimeout(()=>dom.popupCenter.classList.add("show"),10)},300)})),dom.popupCenter.addEventListener("click",(function(e){e.stopPropagation()})),dom.overlay.addEventListener("click",hideAllPopups),document.body.addEventListener("click",hideAllPopups),[dom.popup01,dom.popupCenter].forEach(p=>{p&&p.addEventListener("click",e=>e.stopPropagation())}),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(dom.btnDl.classList.add("d-none"),window.location.href=host+getSearchParams()),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),console.log("stop install"),deferredPrompt=e});
